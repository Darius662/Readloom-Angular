<div class="search-details-modal">
  <div class="modal-header">
    <h5 class="modal-title">Item Details</h5>
    <button type="button" class="btn-close" (click)="closeModal()" aria-label="Close"></button>
  </div>

  <div class="modal-body">
    <div class="row">
      <!-- Cover Image and Controls -->
      <div class="col-md-3">
        <img [src]="item.cover_url || '/assets/no-cover.png'" 
             [alt]="item.title || item.name"
             class="img-fluid rounded"
             onerror="this.src='/assets/no-cover.png'">
        
        <div class="mt-3">
          <!-- Content Type Label -->
          <div class="mb-2">
            <label class="form-label small mb-1">Content Type</label>
          </div>

          <!-- Content Type Selection Dropdown -->
          <div class="mb-3">
            <select class="form-select form-select-sm" 
                    [(ngModel)]="item.content_type"
                    name="contentType">
              <option value="MANGA">Manga</option>
              <option value="MANHWA">Manhwa</option>
              <option value="MANHUA">Manhua</option>
              <option value="COMICS">Comics</option>
              <option value="NOVEL">Novels</option>
              <option value="BOOK">Book</option>
              <option value="OTHER">Other</option>
            </select>
          </div>

          <!-- Add to Collection Button -->
          <button class="btn btn-success w-100 mb-2" 
                  (click)="handlePrimaryAction()"
                  [disabled]="isLoading">
            @if (isLoading) {
              <i class="fas fa-spinner fa-spin me-2"></i> {{ isInLibrary ? 'Loading...' : 'Adding...' }}
            } @else {
              <i class="fas fa-{{ isInLibrary ? 'arrow-right' : 'plus-circle' }} me-2"></i> {{ primaryButtonText }}
            }
          </button>

          <!-- Remove from Want to Read Button -->
          <button class="btn btn-outline-warning w-100" 
                  (click)="removeFromWantToRead()"
                  [disabled]="isLoading">
            @if (isLoading) {
              <i class="fas fa-spinner fa-spin me-2"></i> Removing...
            } @else {
              <i class="fas fa-bookmark me-2"></i> Remove from Want to Read
            }
          </button>
        </div>
      </div>

      <!-- Details -->
      <div class="col-md-9">
        <h4 class="mb-3">{{ item.title || item.name || 'Unknown Title' }}</h4>
        
        @if (item.alternative_titles && item.alternative_titles.length > 0) {
          <div id="modalAltTitles" class="text-muted small mb-3">
            Also known as: {{ item.alternative_titles.join(', ') }}
          </div>
        } @else {
          <div id="modalAltTitles" class="text-muted small mb-3"></div>
        }
        
        <!-- Status and Rating -->
        <div class="mb-3">
          <span class="badge bg-primary me-1">{{ item.status || 'Unknown' }}</span>
          @if (item.rating) {
            <span class="badge bg-warning">
              <i class="fas fa-star me-1"></i> {{ item.rating }}
            </span>
          }
        </div>
        
        <!-- Author info -->
        <div id="modalAuthor" class="mb-4">
          <strong>Author:</strong> {{ item.author || 'Unknown' }}
        </div>
        
        <!-- Book-specific fields -->
        <div class="book-fields">
          @if (item.publisher) {
            <div class="mb-3">
              <strong>Publisher:</strong> <span id="modalPublisher">{{ item.publisher }}</span>
            </div>
          }
          
          @if (item.published_date) {
            <div class="mb-3">
              <strong>Published:</strong> <span id="modalPublishedDate">{{ item.published_date }}</span>
            </div>
          }
          
          @if (item.isbn) {
            <div class="mb-3">
              <strong>ISBN:</strong> <span id="modalISBN">{{ item.isbn }}</span>
            </div>
          }
        </div>
        
        <!-- Genres/Subjects -->
        <div class="mb-4">
          <strong>Genres:</strong>
          <div id="modalGenres" class="mt-2">
            @if (item.genres && item.genres.length > 0) {
              @for (genre of item.genres; track genre) {
                <span class="text-muted me-2">{{ genre }}</span>
              }
            } @else {
              <span class="text-muted">No genres available</span>
            }
          </div>
        </div>
        
        <!-- Description -->
        <div class="mb-3">
          <strong>Description:</strong>
          <div id="modalDescription" class="mt-2 description-scroll">
            @if (item.description) {
              {{ item.description }}
            } @else {
              <span class="text-muted">No description available</span>
            }
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="modal-footer">
    <button type="button" class="btn btn-secondary" (click)="closeModal()">Close</button>
  </div>
</div>
