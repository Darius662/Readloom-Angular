// Readloom Angular Material Theme
// Using Angular Material 21 API with Material 3 design tokens
@use '@angular/material' as mat;

// Import Bootstrap
@import 'bootstrap/dist/css/bootstrap.min.css';

// Import Font Awesome
@import '@fortawesome/fontawesome-free/css/all.css';

// Bootstrap Dialog Container Override
.bootstrap-dialog-container .mat-mdc-dialog-container {
  padding: 0 !important;
  border-radius: 0.375rem !important;
  overflow: hidden !important;
  background: transparent !important;
  max-width: 95vw !important;
  margin: 0 auto !important;
  max-height: 90vh !important;
}

.bootstrap-dialog-container .mat-mdc-dialog-surface {
  padding: 0 !important;
  border-radius: 0.375rem !important;
  overflow: hidden !important;
  width: 600px !important;
  max-width: 95vw !important;
  background: transparent !important;
  margin: 0 auto !important;
  max-height: 90vh !important;
  display: flex !important;
  flex-direction: column !important;
}

.bootstrap-dialog-container .mat-mdc-dialog-content {
  max-height: calc(90vh - 120px) !important;
  overflow-y: auto !important;
  overflow-x: hidden !important;
  padding: 24px !important;
}

.bootstrap-dialog-container .mat-mdc-dialog-actions {
  flex-shrink: 0 !important;
  padding: 16px 24px !important;
  border-top: 1px solid #dee2e6 !important;
  background-color: #fff !important;
}

// Universal Modal Height Fix - applies to ALL modals
.mat-mdc-dialog-container {
  max-height: 90vh !important;
  overflow: visible !important;
  position: fixed !important;
  top: 50% !important;
  left: 50% !important;
  transform: translate(-50%, -50%) !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
}

.mat-mdc-dialog-surface {
  max-height: 90vh !important;
  overflow: visible !important;
  display: flex !important;
  flex-direction: column !important;
  background-color: #fff !important;
  border-radius: 4px !important;
  box-shadow: 0 11px 15px -7px rgba(0, 0, 0, 0.2), 0 24px 38px 3px rgba(0, 0, 0, 0.14), 0 9px 46px 8px rgba(0, 0, 0, 0.12) !important;
  position: relative !important;
  width: auto !important;
  min-width: 300px !important;
  max-width: 90vw !important;
  // Remove all padding and margins
  padding: 0 !important;
  margin: 0 !important;
}

.mat-mdc-dialog-content {
  max-height: calc(90vh - 140px) !important;
  overflow-y: auto !important;
  overflow-x: hidden !important;
  padding: 24px !important;
  background-color: #fff !important;
  flex: 1 1 auto !important;
  min-height: 0 !important;
  color: #212529 !important;
}

.mat-mdc-dialog-actions {
  flex-shrink: 0 !important;
  padding: 16px 24px !important;
  border-top: 1px solid #dee2e6 !important;
  background-color: #fff !important;
  position: relative !important;
  margin-top: auto !important;
}

// Fix modal header width consistency
.mat-mdc-dialog-title {
  color: #212529 !important;
  font-weight: 500 !important;
  margin: 0 !important;
  padding: 0 !important;
  line-height: 1.5 !important;
}

// Fix confirmation dialog specific issues
.mat-mdc-dialog-container.confirmation-dialog .mat-mdc-dialog-surface {
  width: 400px !important;
  max-width: 90vw !important;
  padding: 0 !important;
}

.mat-mdc-dialog-container.confirmation-dialog .mat-mdc-dialog-content {
  padding: 16px 24px !important;
  color: #212529 !important;
}

.mat-mdc-dialog-container.confirmation-dialog .mat-mdc-dialog-title {
  color: #212529 !important;
  font-size: 1.25rem !important;
  font-weight: 500 !important;
  margin-bottom: 16px !important;
}

.mat-mdc-dialog-container.confirmation-dialog .mat-mdc-dialog-content p {
  color: #495057 !important;
  line-height: 1.5 !important;
  margin: 0 !important;
}

.mat-mdc-dialog-container.confirmation-dialog .mat-mdc-dialog-actions {
  padding: 8px 24px !important;
}

// Dialog message styling - exactly as specified
.dialog-message {
  margin: 0 !important;
  color: #212529 !important;
  line-height: 1.7 !important;
  font-size: 16px !important;
  word-break: break-word !important;
}

// Dialog header styling - exactly as specified
.dialog-header {
  display: flex !important;
  align-items: flex-start !important;
  gap: 18px !important;
  padding: 11px !important;
  border-radius: 0px 0px 0 0 !important;
  margin: -0px -0px 0 -0px !important;
}

// More aggressive surface targeting - REMOVE all default styling
.mdc-dialog__surface {
  max-height: 90vh !important;
  overflow: visible !important;
  display: flex !important;
  flex-direction: column !important;
  background-color: #fff !important;
  border-radius: 4px !important;
  position: relative !important;
  // Remove all padding and margins
  padding: 0 !important;
  margin: 0 !important;
  // Override any Material Design defaults
  min-width: unset !important;
  min-height: unset !important;
  width: unset !important;
  height: unset !important;
  box-sizing: border-box !important;
}

.mat-mdc-dialog-surface.mdc-dialog__surface {
  max-height: 90vh !important;
  overflow: visible !important;
  display: flex !important;
  flex-direction: column !important;
  background-color: #fff !important;
  border-radius: 4px !important;
  position: relative !important;
  // Remove all padding and margins
  padding: 0 !important;
  margin: 0 !important;
  // Override any Material Design defaults
  min-width: unset !important;
  min-height: unset !important;
  width: unset !important;
  height: unset !important;
  box-sizing: border-box !important;
}

// CSS Custom Properties to override Material Design defaults
:root {
  --mat-dialog-surface-padding: 0px;
  --mat-dialog-surface-margin: 0px;
  --mdc-dialog-surface-padding: 0px;
  --mdc-dialog-surface-margin: 0px;
}

// Override Material Design CSS variables
.mat-mdc-dialog-surface {
  padding: var(--mat-dialog-surface-padding, 0) !important;
  margin: var(--mat-dialog-surface-margin, 0) !important;
}

.mdc-dialog__surface {
  padding: var(--mdc-dialog-surface-padding, 0) !important;
  margin: var(--mdc-dialog-surface-margin, 0) !important;
}

.mat-mdc-dialog-surface.mdc-dialog__surface {
  padding: var(--mat-dialog-surface-padding, 0) !important;
  margin: var(--mat-dialog-surface-margin, 0) !important;
}

// Universal reset for all dialog surfaces
[class*="dialog-surface"] {
  padding: 0 !important;
  margin: 0 !important;
}

// Most specific selectors possible
.cdk-overlay-pane .mat-mdc-dialog-container .mat-mdc-dialog-surface {
  padding: 0 !important;
  margin: 0 !important;
}

.cdk-overlay-pane .mat-mdc-dialog-container .mdc-dialog__surface {
  padding: 0 !important;
  margin: 0 !important;
}

.cdk-overlay-pane .mat-mdc-dialog-container .mat-mdc-dialog-surface.mdc-dialog__surface {
  padding: 0 !important;
  margin: 0 !important;
}

// Override with !important and specificity
body .mat-mdc-dialog-surface {
  padding: 0 !important;
  margin: 0 !important;
}

body .mdc-dialog__surface {
  padding: 0 !important;
  margin: 0 !important;
}

body .mat-mdc-dialog-surface.mdc-dialog__surface {
  padding: 0 !important;
  margin: 0 !important;
}

// Force container positioning
.cdk-global-overlay-wrapper {
  pointer-events: none !important;
}

.cdk-overlay-container {
  pointer-events: none !important;
}

.cdk-overlay-pane {
  pointer-events: auto !important;
  max-height: 90vh !important;
  overflow: visible !important;
  position: relative !important;
}

// Specific fix for confirmation dialogs
.mat-mdc-dialog-container.confirmation-dialog {
  max-height: 80vh !important;
}

.mat-mdc-dialog-container.confirmation-dialog .mat-mdc-dialog-surface {
  max-height: 80vh !important;
  min-height: auto !important;
}

.mat-mdc-dialog-container.confirmation-dialog .mat-mdc-dialog-content {
  max-height: calc(80vh - 120px) !important;
  overflow-y: auto !important;
}

// Responsive Modal Styling
@media (max-width: 768px) {
  .mat-mdc-dialog-container {
    max-height: 95vh !important;
    width: 95vw !important;
    margin: 2.5vh auto !important;
  }
  
  .mat-mdc-dialog-surface {
    max-height: 95vh !important;
    width: 100% !important;
  }
  
  .mdc-dialog__surface {
    max-height: 95vh !important;
    width: 100% !important;
  }
  
  .mat-mdc-dialog-content {
    max-height: calc(95vh - 120px) !important;
    padding: 16px !important;
  }
  
  .mat-mdc-dialog-actions {
    padding: 12px 16px !important;
  }
}

@media (max-width: 480px) {
  .mat-mdc-dialog-container {
    max-height: 98vh !important;
    width: 98vw !important;
    margin: 1vh auto !important;
  }
  
  .mat-mdc-dialog-surface {
    max-height: 98vh !important;
    width: 100% !important;
  }
  
  .mdc-dialog__surface {
    max-height: 98vh !important;
    width: 100% !important;
  }
  
  .mat-mdc-dialog-content {
    max-height: calc(98vh - 100px) !important;
    padding: 12px !important;
  }
  
  .mat-mdc-dialog-actions {
    padding: 8px 12px !important;
  }
}

/* Dark mode dialog container */
@media (prefers-color-scheme: dark) {
  .bootstrap-dialog-container .mat-mdc-dialog-container {
    background: transparent !important;
  }
  
  .bootstrap-dialog-container .mat-mdc-dialog-surface {
    background: transparent !important;
  }
  
  .mat-mdc-dialog-surface {
    background-color: #212529 !important;
    color: #fff !important;
  }
  
  .mdc-dialog__surface {
    background-color: #212529 !important;
    color: #fff !important;
  }
  
  .mat-mdc-dialog-content {
    background-color: #212529 !important;
    color: #fff !important;
  }
  
  .mat-mdc-dialog-title {
    color: #fff !important;
  }
  
  .mat-mdc-dialog-actions {
    background-color: #212529 !important;
    border-top-color: #495057 !important;
  }
  
  // Dark theme fixes for confirmation dialog
  .mat-mdc-dialog-container.confirmation-dialog .mat-mdc-dialog-content {
    color: #fff !important;
  }
  
  .mat-mdc-dialog-container.confirmation-dialog .mat-mdc-dialog-title {
    color: #fff !important;
  }
  
  .mat-mdc-dialog-container.confirmation-dialog .mat-mdc-dialog-content p {
    color: #adb5bd !important;
  }
  
  // Dark theme for dialog message
  .dialog-message {
    color: #fff !important;
  }
  
  // Dark theme for dialog header
  .dialog-header {
    background-color: #dc3545 !important; // Red background for danger/warning
    color: #fff !important;
  }
  
  // Dark theme for edit collection dialog header
  .edit-collection-dialog .dialog-header {
    background-color: #0d6efd !important; // Blue background for editing
    color: #fff !important;
  }
  
  // Dark theme for edit root folder dialog header
  .edit-root-folder-dialog .dialog-header {
    background-color: #6f42c1 !important; // Purple/indigo background for editing
    color: #fff !important;
  }
}

// Light theme dialog header colors
.edit-collection-dialog .dialog-header {
  background-color: #0d6efd !important; // Blue background for editing
  color: #fff !important;
}

.edit-root-folder-dialog .dialog-header {
  background-color: #6f42c1 !important; // Purple/indigo background for editing
  color: #fff !important;
}

/* App theme detection */
body.dark-theme .bootstrap-dialog-container .mat-mdc-dialog-container {
  background: transparent !important;
}

body.dark-theme .bootstrap-dialog-container .mat-mdc-dialog-surface {
  background: transparent !important;
}

// ============================================
// Define theme using Angular Material 21 API
// ============================================

// Theme configuration
$readloom-theme: (
  color: mat.$blue-palette,
  typography: Roboto,
  density: 0
);

// Apply theme with light-dark support
html {
  color-scheme: dark light;
  @include mat.theme($readloom-theme);

  // Override Material's auto-generated primary color with our brand color
  // Same color as primary for both themes
  @include mat.theme-overrides((
    primary: #0d6efd,
  ));
}

// ============================================
// CSS Custom Properties (for use in components)
// ============================================

:root {
  // Colors from original design
  --primary-color: #0d6efd;
  --secondary-color: #757575;
  --success-color: #4caf50;
  --danger-color: #f44336;
  --warning-color: #ff9800;
  --info-color: #00bcd4;

  // Dark theme colors (default)
  --bg-color: #212529;
  --bg-card: #2c3034;
  --bg-hover: #3a3e42;
  --border-color: #373b3e;
  --text-primary: #f8f9fa;
  --text-secondary: #adb5bd;

  // Utilities
  --border-radius: 4px;
  --box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
  --box-shadow-hover: 0 4px 12px rgba(0, 0, 0, 0.3);
}

.light-theme {
  color-scheme: light;
  --bg-color: #fafafa;
  --bg-card: #ffffff;
  --bg-hover: #f0f0f0;
  --border-color: #e0e0e0;
  --text-primary: #212529;
  --text-secondary: #757575;
  --box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  --box-shadow-hover: 0 4px 12px rgba(0, 0, 0, 0.15);
}

// ============================================
// Global Styles
// ============================================

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
  width: 100%;
  overflow-x: hidden;
}

html, body {
  height: 100%;
}

body {
  font-family: Roboto, 'Segoe UI', 'Helvetica Neue', Arial, sans-serif;
  background-color: var(--bg-color);
  color: var(--text-primary);
  line-height: 1.6;
  font-weight: 400;
  letter-spacing: 0.3px;
  width: 100%;
  overflow-x: hidden;
}

main {
  width: 100%;
  overflow-x: hidden;
}

// ============================================
// Scrollbar Styling
// ============================================

::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}

::-webkit-scrollbar-track {
  background: var(--bg-card);
}

::-webkit-scrollbar-thumb {
  background: var(--secondary-color);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: var(--text-secondary);
}

// ============================================
// Angular Material Overrides
// ============================================

// Cards
.mat-mdc-card {
  background-color: var(--bg-card) !important;
  border: 1px solid var(--border-color);
  box-shadow: var(--box-shadow) !important;

  &:hover {
    box-shadow: var(--box-shadow-hover) !important;
  }
}

// Form fields
.mat-mdc-form-field {
  .mdc-text-field--filled {
    background-color: var(--bg-card);
  }
}

// Tables
.mat-mdc-table {
  background-color: var(--bg-card) !important;
}

.mat-mdc-header-row {
  background-color: var(--bg-color);
}

.mat-mdc-row:hover {
  background-color: rgba(13, 110, 253, 0.1);
}

// Dialogs
.mat-mdc-dialog-container {
  --mat-dialog-container-color: var(--bg-card);
}

// Sidenav
.mat-sidenav {
  background-color: var(--bg-card);
}

.mat-sidenav-content {
  background-color: var(--bg-color);
}

// Toolbar
.mat-toolbar {
  background-color: var(--bg-card);
  color: var(--text-primary);
  width: 100% ;
}

// ============================================
// Utility Classes
// ============================================

.text-primary {
  color: var(--primary-color) !important;
}

.text-success {
  color: var(--success-color) !important;
}

.text-danger {
  color: var(--danger-color) !important;
}

.text-warning {
  color: var(--warning-color) !important;
}

.text-info {
  color: var(--info-color) !important;
}

.text-muted {
  color: var(--text-secondary) !important;
}

.bg-primary {
  background-color: var(--primary-color) !important;
}

.bg-success {
  background-color: var(--success-color) !important;
}

.bg-danger {
  background-color: var(--danger-color) !important;
}

.bg-warning {
  background-color: var(--warning-color) !important;
}

.bg-info {
  background-color: var(--info-color) !important;
}
