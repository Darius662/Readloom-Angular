{% extends "base.html" %}

{% block title %}Collections - Readloom{% endblock %}

{% block content %}
<div class="container-fluid">
    <div class="row">
        <div class="col-12">
            <h1 class="mb-4">
                Collections
                <i class="fas fa-info-circle ms-2" style="cursor: help; color: #0d6efd;" data-bs-toggle="tooltip" data-bs-placement="right" title="Collections allow you to organize your manga/comics into groups and connect them to specific root folders. Each collection can have multiple root folders, and each root folder can be used by multiple collections. You must have at least one collection and one root folder before you can add manga/comics to your library."></i>
            </h1>
            
            <div class="row mb-4">
                <div class="col-md-6">
                    <div class="card">
                        <div class="card-header d-flex justify-content-between align-items-center">
                            <h5 class="mb-0">Collections</h5>
                            <button class="btn btn-sm btn-primary" id="addCollectionBtn">
                                <i class="fas fa-plus"></i> Add Collection
                            </button>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-striped table-hover" id="collectionsTable">
                                    <thead>
                                        <tr>
                                            <th>Name</th>
                                            <th>Root Folders</th>
                                            <th>Series</th>
                                            <th>Default</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="collectionsTableBody">
                                        <tr>
                                            <td colspan="5" class="text-center">Loading collections...</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="col-md-6">
                    <div class="card">
                        <div class="card-header d-flex justify-content-between align-items-center">
                            <h5 class="mb-0">Root Folders</h5>
                            <button class="btn btn-sm btn-primary" id="addRootFolderBtn">
                                <i class="fas fa-plus"></i> Add Root Folder
                            </button>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-striped table-hover" id="rootFoldersTable">
                                    <thead>
                                        <tr>
                                            <th>Name</th>
                                            <th>Path</th>
                                            <th>Content Type</th>
                                            <th>Status</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="rootFoldersTableBody">
                                        <tr>
                                            <td colspan="5" class="text-center">Loading root folders...</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="card mb-4" id="collectionDetailsCard" style="display: none;">
                <div class="card-header">
                    <h5 class="mb-0" id="collectionDetailsTitle">Collection Details</h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6">
                            <h6>Root Folders</h6>
                            <div class="table-responsive">
                                <table class="table table-sm table-striped" id="collectionRootFoldersTable">
                                    <thead>
                                        <tr>
                                            <th>Name</th>
                                            <th>Path</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="collectionRootFoldersTableBody">
                                    </tbody>
                                </table>
                            </div>
                            <div class="mt-2">
                                <button class="btn btn-sm btn-primary" id="addRootFolderToCollectionBtn">
                                    <i class="fas fa-plus"></i> Add Root Folder
                                </button>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <h6>Series</h6>
                            <div class="table-responsive">
                                <table class="table table-sm table-striped" id="collectionSeriesTable">
                                    <thead>
                                        <tr>
                                            <th>Title</th>
                                            <th>Type</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="collectionSeriesTableBody">
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Add Collection Modal -->
<div class="modal fade" id="addCollectionModal" tabindex="-1" aria-labelledby="addCollectionModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="addCollectionModalLabel">Add Collection</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="addCollectionForm">
                    <div class="mb-3">
                        <label for="collectionName" class="form-label">Name</label>
                        <input type="text" class="form-control" id="collectionName" required>
                    </div>
                    <div class="mb-3">
                        <label for="collectionDescription" class="form-label">Description</label>
                        <textarea class="form-control" id="collectionDescription" rows="3"></textarea>
                    </div>
                    <div class="mb-3 form-check">
                        <input type="checkbox" class="form-check-input" id="collectionIsDefault">
                        <label class="form-check-label" for="collectionIsDefault">Set as default collection</label>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" id="saveCollectionBtn">Save</button>
            </div>
        </div>
    </div>
</div>

<!-- Edit Collection Modal -->
<div class="modal fade" id="editCollectionModal" tabindex="-1" aria-labelledby="editCollectionModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="editCollectionModalLabel">Edit Collection</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="editCollectionForm">
                    <input type="hidden" id="editCollectionId">
                    <div class="mb-3">
                        <label for="editCollectionName" class="form-label">Name</label>
                        <input type="text" class="form-control" id="editCollectionName" required>
                    </div>
                    <div class="mb-3">
                        <label for="editCollectionDescription" class="form-label">Description</label>
                        <textarea class="form-control" id="editCollectionDescription" rows="3"></textarea>
                    </div>
                    <div class="mb-3 form-check">
                        <input type="checkbox" class="form-check-input" id="editCollectionIsDefault">
                        <label class="form-check-label" for="editCollectionIsDefault">Set as default collection</label>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" id="updateCollectionBtn">Update</button>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/collections.js') }}"></script>
<script>
    // Initialize tooltips
    document.addEventListener('DOMContentLoaded', function() {
        const tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
        const tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
            return new bootstrap.Tooltip(tooltipTriggerEl);
        });
    });
</script>
{% endblock %}
